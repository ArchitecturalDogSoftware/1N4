# 1N4

> Your resident M41D Unit, here to help with your server.

1N4, pronounced 'ee-nah' (/in√§/),
is a Discord bot made for a private Minecraft SMP.

It provides moderation capabilities and various useful features,
while also including built-in lore through the official bot.
None of the bot's lore will be provided through this repository for the sake of secrecy.
Spoilers are no fun!

1N4 probably isn't for you, as it is highly specialized for what our server needs as a group.

## Usage

You may invite 1N4 using her [invitation link](https://discord.com/oauth2/authorize?client_id=1265640027896021106),
or you can install and run her directly through Git and Cargo.

```sh
# Clone and move into the repository.
git clone 'https://github.com/ArchitecturalDogSoftware/1N4.git'
cd 1N4

# Build in release mode.
cargo build --release

# Relocate the binary and clean up build artifacts.
mv ./target/release/ina .
cargo clean

./ina --help
```

If you are running your own instance of 1N4, ensure that the following environment variables are set to get full functionality:

- `DISCORD_TOKEN` - The bot's Discord token,
  which is required to connect to their API.
  This can be generated by [creating a new application](https://discord.com/developers/applications).
- `DEVELOPMENT_GUILD_ID` - The bot's 'development guild',
  which is where the bot will accept interactions from when not running in release mode.
- `DEVELOPMENT_CHANNEL_ID` - The bot's 'development channel',
  which is where things like error logs are sent.
  1N4 assumes that the given channel is within the guild specified by `DEVELOPMENT_GUILD_ID`
- `ENCRYPTION_KEY` - The password used for encrypting and decrypting sensitive files.

### Docker

Alternatively, 1N4 is available through a Docker container running Alpine Linux.
You can use the default settings with `docker compose up`,
but this requires that `HOST_USER` be set in the environment (such as with another line in `.env`)
to your Unix user ID and group ID separated with a colon, such as `1002:1002`.
If you'd like to export the built image
or apply command-line arguments to the running container without editing `compose.yml`
by building and running manually:

```sh
# Build for the host platform.
docker buildx build --tag 'ArchitecturalDogSoftware/ina' .

# Or build for another target.
#
# Compiles for the target triple `$TARGET_ARCH_RUST-unknown-linux-musl`.
docker buildx build --tag 'ArchitecturalDogSoftware/ina' \
    --platform 'arm64' --build-arg 'TARGET_ARCH_RUST=aarch64' \
    .

# Give the user in the Docker container permissions to write to necessary
# directories. You can skip mounting `./log/` if you set `--no-file-logging`
# and use Docker's native logging facilities instead.
chown -R 10001:10001 './log' './res/data'

# Start the Docker container and attach the TTY.
#
# Instead of `--env-file`, you could manually set each of the required
# environment variables using `--env VAR=value`. You can also let 1N4 load
# environment variables from `.env` instead of Docker by mounting it:
# `--mount 'type=bind,source=./.env,target=/app/.env,readonly'`.
docker run --tty \
    --env-file '.env' \
    --mount 'type=bind,source=./log,target=/app/log' \
    --mount 'type=bind,source=./res,target=/app/res,readonly' \
    --mount 'type=bind,source=./res/data,target=/app/res/data' \
    'ArchitecturalDogSoftware/ina'

# Reset ownership of the necessary directories back to the current user.
chown -R "$(id -u):$(id -g)" './log' './res/data'
```

If a different target CPU architecture is chosen,
Rust will cross-compile for that architecture from a native image.
The last build step that puts the image together still relies on emulating the target architecture, however.
[Documentation](https://docs.docker.com/build/building/multi-platform/#qemu) points towards [`tonistiigi/binfmt`](https://github.com/tonistiigi/binfmt)
as being the easy option to set up QEMU for this,
but your package manager may provide its own packages if you prefer that.
For example, one can set up emulation on Ubuntu 24.04 (and probably other Debian derivatives) like so:

```sh
apt install 'binfmt-support' 'qemu-user-static'

qemu_ref='master' # Or set to a specific version, e.g., `v8.2.2`.
curl --fail --show-error --location --remote-name \
    "https://raw.githubusercontent.com/qemu/qemu/refs/heads/$qemu_ref/scripts/qemu-binfmt-conf.sh"
chmod u+x './qemu-binfmt-conf.sh'

# `--systemd 'ALL'` registers every interpreter at startup with a systemd
# service. Without this flag, you'll have to re-run this script every time you
# restart. You can also specify individual CPU architectures to register, `ALL`
# registers every architecture supported by QEMU.
#
# `./qemu-binfmt-conf.sh --help` for more information.
./qemu-binfmt-conf.sh --qemu-suffix '-static' --qemu-path '/usr/bin' \
    --persistent 'yes' \
    --systemd 'ALL'
```

## Contributing

Contributions are always welcome!
If you're interested in helping development, please read 1N4's [contribution guidelines](./docs/CONTRIBUTING.md).
Contributors are expected to have read and understood the contents of this document.

If you ever need help, feel free to contact me here or on Discord, and I will do my best to assist you \<3

### Reporting Security Issues

Please see 1N4's [security reporting guidelines](./docs/SECURITY.md).

## Governance

1N4 is primarily authored by Jaxydog,
but as an ArchitecturalDog Software project,
RemasteredArch is a maintainer as well.
Jaxydog is also the operator of 1N4's primary instance.
You can get in touch with us by
[opening an issue](https://github.com/ArchitecturalDogSoftware/1N4/issues) (our preference)
or sending us an email at <ArchitecturalDogSoftware@gmail.com>.

1N4 does not currently have any formal community governance.
However, we are still open to suggestions ---
[contributions](./docs/CONTRIBUTING.md) are welcome,
whether that is code, documentation, ideas, or anything else that makes a project shine!

## Privacy Policy

Please see 1N4's [privacy policy](./docs/PRIVACY_POLICY.md).

## License

1N4 is free software: you can redistribute it and/or modify it
under the terms of the GNU Affero General Public License as published by the Free Software Foundation,
either version 3 of the License, or (at your option) any later version.

1N4 is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.
See the GNU Affero General Public License for more details.

You should have received a copy of the GNU Affero General Public License along with 1N4 (located within [LICENSE](./LICENSE)).
If not, see <https://www.gnu.org/licenses/>.

Powered by transgender spiders üï∑Ô∏è üï∏Ô∏è üè≥Ô∏è‚Äç‚ößÔ∏è.
